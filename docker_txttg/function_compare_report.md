| 原始函数名/类名 | 原始文件 | 拆分后文件 | 是否一致 | 备注/变动说明 |
|---|---|---|---|---|
| split_message           | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| set_bot_username        | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| get_user_vip_level      | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| get_file_by_id          | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| get_uploaded_file_by_id | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| search_files_by_name    | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| search_uploaded_files_by_name | rm/search_file.py   | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| update_file_tg_id       | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| update_uploaded_file_tg_id | rm/search_file.py       | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| build_search_keyboard   | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| build_uploaded_search_keyboard | rm/search_file.py   | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| search_command          | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| search_callback         | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| ss_command              | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| ss_callback             | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| send_ss_page            | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| add_page_button         | rm/search_file.py         | handlers/search.py         | 一致    | 仅import路径变化，逻辑一致 |
| get_user_points         | rm/points_system.py       | utils/calculations.py      | 一致    | 仅import路径变化，逻辑一致 |
| add_points             | rm/points_system.py       | utils/calculations.py      | 一致    | 仅import路径变化，逻辑一致 |
| can_checkin            | rm/points_system.py       | handlers/points.py         | 一致    | 仅import路径变化，逻辑一致 |
| update_last_checkin    | rm/points_system.py       | handlers/points.py         | 一致    | 仅import路径变化，逻辑一致 |
| calculate_points_for_days | rm/points_system.py    | utils/calculations.py      | 一致    | 仅import路径变化，逻辑一致 |
| checkin_command        | rm/points_system.py       | handlers/points.py         | 一致    | 仅import路径变化，逻辑一致 |
| points_command         | rm/points_system.py       | handlers/points.py         | 一致    | 仅import路径变化，逻辑一致 |
| exchange_callback      | rm/points_system.py       | handlers/vip.py            | 一致    | 仅import路径变化，逻辑一致 |
| cancel_callback        | rm/points_system.py       | handlers/vip.py            | 一致    | 仅import路径变化，逻辑一致 |
| upgrade_vip_level      | rm/points_system.py       | handlers/vip.py/points.py  | 一致    | 仅import路径变化，逻辑一致 |
| is_vip_active          | rm/points_system.py       | handlers/vip.py/points.py  | 一致    | 仅import路径变化，逻辑一致 |
| get_vip_info           | rm/points_system.py       | handlers/vip.py            | 一致    | 仅import路径变化，逻辑一致 |
| get_package_points     | rm/points_system.py       | utils/calculations.py/handlers/vip.py/points.py | 一致 | 仅import路径变化，逻辑一致 |
| handle_document         | rm/document_handler.py     | handlers/document.py       | 有差异  | 逻辑大体一致，部分参数、流程和存储路径有调整，管理员通知方式略有不同 |
| handle_document_callback| rm/document_handler.py     | handlers/document.py       | 基本一致| 主要流程一致，部分细节如回调数据解析、通知方式有微调 |
| batch_approve_command  | rm/document_handler.py     | handlers/document.py       | 基本一致| 主要流程一致，部分细节如通知方式有微调 |
| get_engine              | rm/orm_utils.py           | utils/db.py                | 有差异  | 拆分后数据库连接配置方式不同，参数和环境变量名有变化** |
| SessionLocal           | rm/orm_utils.py           | utils/db.py                | 有差异  | 拆分后SessionLocal初始化方式不同，依赖全局DATABASE_URL **|
| init_db                | rm/orm_utils.py           | utils/db.py                | 有差异  | 拆分后未直接暴露init_db函数，表结构初始化方式不同** |
| User                    | rm/orm_models.py          | utils/db.py                | 一致    | 类结构、字段一致 |
| File                    | rm/orm_models.py          | utils/db.py                | 一致    | 类结构、字段一致 |
| SentFile                | rm/orm_models.py          | utils/db.py                | 一致    | 类结构、字段一致 |
| FileFeedback            | rm/orm_models.py          | utils/db.py                | 一致    | 类结构、字段一致 |
| UploadedDocument        | rm/orm_models.py          | utils/db.py                | 一致    | 类结构、字段一致 |
| LicenseCode             | rm/orm_models.py          | utils/db.py                | 一致    | 类结构、字段一致 |
| __repr__                | rm/orm_models.py          | utils/db.py                | 一致    | 方法内容一致     |
| before_cursor_execute   | rm/main.py                | 无                         | 有差异  | 仅主程序SQL调试用，未拆分   |
| after_cursor_execute    | rm/main.py                | 无                         | 有差异  | 仅主程序SQL调试用，未拆分   |
| get_or_create_file      | rm/main.py                | utils/file.py              | 一致    | 仅import路径变化，逻辑一致 |
| ensure_user             | rm/main.py                | services/user_service.py   | 一致    | 仅import路径变化，逻辑一致 |
| set_user_vip_level      | rm/main.py                | services/user_service.py/handlers/vip.py | 一致 | 仅import路径变化，逻辑一致 |
| get_user_vip_level      | rm/main.py                | services/user_service.py/handlers/search.py | 有差异 | 拆分后部分返回值和逻辑有调整 |
| get_sent_file_ids       | rm/main.py                | services/user_service.py   | 一致    | 仅import路径变化，逻辑一致 |
| mark_file_sent          | rm/main.py                | services/file_service.py   | 一致    | 仅import路径变化，逻辑一致 |
| get_today_sent_count    | rm/main.py                | utils/calculations.py      | 一致    | 仅import路径变化，逻辑一致 |
| upgrade_files_table     | rm/main.py                | 无                         | 有差异  | ORM自动管理，无需手动升级   |
| upgrade_users_table     | rm/main.py                | utils/db.py                | 有差异  | 拆分后实现方式不同         |
| reload_txt_files        | rm/main.py                | utils/file.py              | 一致    | 仅import路径变化，逻辑一致 |
| record_feedback         | rm/main.py                | handlers/feedback.py       | 一致    | 仅import路径变化，逻辑一致 |
| get_unsent_files        | rm/main.py                | services/file_service.py   | 一致    | 仅import路径变化，逻辑一致 |
| send_file_job           | rm/main.py                | handlers/random.py         | 一致    | 仅import路径变化，逻辑一致 |
| send_random_txt         | rm/main.py                | handlers/random.py         | 一致    | 仅import路径变化，逻辑一致 |
| stats                   | rm/main.py                | handlers/stats.py          | 一致    | 仅import路径变化，逻辑一致 |
| hot                     | rm/main.py                | handlers/hot.py            | 一致    | 仅import路径变化，逻辑一致 |
| hot_callback            | rm/main.py                | handlers/hot.py            | 一致    | 仅import路径变化，逻辑一致 |
| send_hot_page           | rm/main.py                | handlers/hot.py            | 一致    | 仅import路径变化，逻辑一致 |
